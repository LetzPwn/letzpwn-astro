---
// Access the current path from the Astro object
const currentPath = Astro.url.pathname

// Define your menu items
const menuItems = [
  { name: 'Home', path: '/' },
  { name: 'About Us', path: '/about' },
  { name: 'News', path: '/news' },
  { name: 'Sponsors', path: '/sponsors' },
  { name: 'Writeups', path: '/writeups' },
  { name: 'Contact', path: '/contact' }
]
---

<header class="main-header">
  <!-- Header Top -->
  <div class="header-top">
    <div class="auto-container clearfix">
      <div class="top-left clearfix">
        <ul class="info-list">
          <li>The first Luxembourgish CTF Team</li>
        </ul>
      </div>

      <div class="top-right">
        <ul class="social-icons">
          <li>
            <a href="https://twitter.com/LetzPwnAsbl">
              <span class="fab fa-twitter"></span>
            </a>
          </li>
          <li>
            <a href="https://instagram.com/letzpwnasbl">
              <span class="fab fa-instagram"></span>
            </a>
          </li>
          <li>
            <a href="https://discord.letzpwn.lu">
              <span class="fab fa-discord"></span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Header Upper -->
  <div class="header-upper">
    <div class="inner-container">
      <div class="auto-container clearfix">
        <!-- Logo -->
        <div class="logo-outer">
          <div class="logo">
            <a href="/">
              <img
                src="/assets/images/logo.png"
                alt=""
                title="LetzPwn"
                style="max-width: 260px;"
              />
            </a>
          </div>
        </div>

        <!-- Nav Box -->
        <div class="nav-outer clearfix">
          <!-- Mobile Navigation Toggler (moved here) -->
          <div class="mobile-nav-toggler">
            <span class="icon flaticon-menu-1"></span>
          </div>

          <!-- Main Menu -->
          <nav class="main-menu navbar-expand-md navbar-light">
            <div
              class="collapse navbar-collapse show clearfix"
              id="navbarSupportedContent"
            >
              <!-- Left Navigation -->
              <ul class="navigation clearfix pull-left">
                {
                  menuItems.slice(0, 3).map((item) => (
                    <li class={currentPath === item.path ? 'current' : ''}>
                      <a href={item.path}>{item.name}</a>
                    </li>
                  ))
                }
              </ul>
              <!-- Right Navigation -->
              <ul class="navigation clearfix pull-right">
                {
                  menuItems.slice(3).map((item) => (
                    <li class={currentPath === item.path ? 'current' : ''}>
                      <a href={item.path}>{item.name}</a>
                    </li>
                  ))
                }
              </ul>
            </div>
          </nav>
          <!-- Main Menu End-->
        </div>
      </div>
    </div>
  </div>
  <!--End Header Upper-->

  <!-- Sticky Header  -->
  <div class="sticky-header">
    <div class="auto-container clearfix">
      <!--Logo-->
      <div class="logo pull-left">
        <a href="/" title="">
          <img
            src="/assets/images/logo.png"
            style="max-width:100px;"
            alt=""
            title=""
          />
        </a>
      </div>
      <!--Right Col-->
      <div class="pull-right">
        <!-- Main Menu -->
        <nav class="main-menu clearfix">
          <!--Keep This Empty / Menu will come through Javascript-->
        </nav>
        <!-- Main Menu End-->
      </div>
    </div>
  </div>
  <!-- End Sticky Menu -->

  <!-- Mobile Menu  -->
  <div class="mobile-menu">
    <div class="menu-backdrop"></div>
    <div class="close-btn"><span class="icon flaticon-close"></span></div>

    <nav class="menu-box">
      <div class="nav-logo">
        <a href="/"><img src="/assets/images/logo.png" alt="" title="" /></a>
      </div>
      <div class="menu-outer"></div>
    </nav>
  </div>
  <!-- End Mobile Menu -->
</header>

<style>
  @media only screen and (max-width: 1023px) {
  .main-header .header-upper .logo img {
    max-height: 80px !important;
    height: auto !important;
    width: auto !important;
    object-fit: contain;
  }
  .main-header .header-upper .logo-outer {
    max-height: 100% !important;
    height: 100px !important;
    width: auto !important;
    object-fit: contain;
    padding: 10px 0 !important;
  }

  .main-header .top-right {
    display: none !important;
  }

  .main-header .header-upper:before,
  .main-header .header-upper .inner-container:before,
  .main-header .header-upper .nav-outer:before {
    display: none !important;
    content: none !important;
  }
}

/* Show when toggled */
.mobile-menu.open {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  z-index: 9999 !important;
}

/* Logo in drawer */
.mobile-menu .nav-logo img {
  max-width: 150px;
  height: auto;
}

/* Mobile nav items */
.mobile-menu .menu-outer ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

.mobile-menu .menu-outer li {
  margin-bottom: 20px;
}

.mobile-menu .menu-outer a {
  color: #fff !important;
  font-size: 18px;
  text-decoration: none;
}

.mobile-menu .menu-box {
  position: fixed !important;
  top: 0 !important;
  right: 0 !important;
  left: auto !important;
  width: 100% !important;
  height: 100% !important;
  background: #000 !important;
  padding: 20px !important;
  overflow-y: auto !important;
  box-sizing: border-box !important;

  opacity: 1 !important;
  visibility: visible !important;
  transform: translateX(100%) !important;

  /* animation */
  transition: transform 0.3s ease !important;
}

/* When open: slide into view */
.mobile-menu.open .menu-box {
  transform: translateX(0) !important;
}

.mobile-menu .close-btn{
  position: absolute !important;
  top: 20px !important;
  right: 20px !important;
  font-size: 24px !important;
  color: #fff !important;
  cursor: pointer !important;
  z-index: 10001 !important;
}
</style>
<script>
document.addEventListener("DOMContentLoaded", () => {

  const toggler = document.querySelector(".mobile-nav-toggler");
  const mobileMenu = document.querySelector(".mobile-menu");
  const backdrop = document.querySelector(".menu-backdrop");
  const closeBtn = document.querySelector(".mobile-menu .close-btn");
  const menuOuter = document.querySelector(".mobile-menu .menu-outer");
  const desktopMenu = document.querySelector(".main-menu .navbar-collapse").innerHTML;

  // Clone desktop menu into mobile menu
  if (menuOuter && desktopMenu) {
    console.log("Cloning menu for mobile");
    menuOuter.innerHTML = desktopMenu;
  }

  // Open mobile menu
  toggler?.addEventListener("click", () => {
    console.log("Opening mobile menu");
    mobileMenu.classList.add("open");
  });

  // Close mobile menu
  const closeMenu = () => mobileMenu.classList.remove("open");
  backdrop?.addEventListener("click", closeMenu);
  closeBtn?.addEventListener("click", closeMenu);
});
</script>
